import pandas as pd
cols = ['eid', 
        '2050-0.0', '2050-1.0', '2050-2.0', '2050-3.0', '2060-0.0', '2060-1.0', '2060-2.0', 
        '2060-3.0', '2070-0.0', '2070-1.0', '2070-2.0', '2070-3.0', '2080-0.0', '2080-1.0',
        '2080-2.0', '2080-3.0', '25752-2.0', '25752-3.0', '20227-2.0', '20227-3.0', '6350-2.0', 
        '6350-3.0', '6351-2.0', '6351-3.0', '20016-0.0', '20016-1.0', '20016-2.0', '20016-3.0', 
        '20197-2.0', '20197-3.0', '23324-2.0', '23324-3.0', '21003-0.0', '21003-1.0', '21003-2.0', 
        '21003-3.0', '34-0.0', '130894-0.0', '130906-0.0', '130910-0.0', '20434-0.0', '42039-0.0', 
        '20433-0.0', '20442-0.0', '25741-2.0', '25741-3.0', '22021-0.0', '31-0.0', '21000-0.0',
        '21000-1.0', '21000-2.0', '54-2.0',
        
        '130837-0.0', '130839-0.0', '130841-0.0', '130843-0.0',
        '130845-0.0', '130847-0.0', '130849-0.0', '130851-0.0', '130853-0.0', '130855-0.0',  # Unhealthy conditions
        '130857-0.0', '130859-0.0', '130861-0.0', '130863-0.0', '130865-0.0', '130867-0.0',
        '130869-0.0', '130871-0.0', '130873-0.0', '130875-0.0', '130877-0.0', '130879-0.0',
        '130881-0.0', '130883-0.0', '130885-0.0', '130887-0.0', '130889-0.0', '130891-0.0',
        '130893-0.0', '130895-0.0', '130897-0.0', '130899-0.0', '130901-0.0', '130903-0.0',
        '130905-0.0', '130907-0.0', '130909-0.0', '130911-0.0', '130913-0.0', '130915-0.0',
        '130917-0.0', '130919-0.0', '130921-0.0', '130923-0.0', '130925-0.0', '130927-0.0',
        '130929-0.0', '130931-0.0', '130933-0.0', '130935-0.0', '130937-0.0', '130939-0.0',
        '130941-0.0', '130943-0.0', '130945-0.0', '130947-0.0', '130949-0.0', '130951-0.0',
        '130953-0.0', '130955-0.0', '130959-0.0', '130961-0.0', '130963-0.0', '130965-0.0',
        '130967-0.0', '130971-0.0', '130973-0.0', '130975-0.0', '130977-0.0', '130979-0.0',
        '130981-0.0', '130983-0.0', '130985-0.0', '130987-0.0', '130989-0.0', '130991-0.0',
        '130993-0.0', '130995-0.0', '130997-0.0', '130999-0.0', '131001-0.0', '131003-0.0',
        '131005-0.0', '131007-0.0', '131009-0.0', '131011-0.0', '131013-0.0', '131015-0.0',
        '131017-0.0', '131019-0.0', '131021-0.0', '131023-0.0', '131025-0.0', '131027-0.0',
        '131029-0.0', '131031-0.0', '131033-0.0', '131037-0.0', '131039-0.0', '131041-0.0',
        '131043-0.0', '131045-0.0', '131047-0.0', '131049-0.0', '131051-0.0', '131053-0.0',
        '131055-0.0', '131057-0.0', '131059-0.0', '131061-0.0', '131063-0.0', '131065-0.0',
        '131067-0.0', '131069-0.0', '131071-0.0', '131073-0.0', '131075-0.0', '131077-0.0',
        '131079-0.0', '131081-0.0', '131083-0.0', '131085-0.0', '131087-0.0', '131089-0.0',
        '131091-0.0', '131093-0.0', '131095-0.0', '131097-0.0', '131099-0.0', '131101-0.0',
        '131103-0.0', '131105-0.0', '131107-0.0', '131109-0.0', '131111-0.0', '131113-0.0',
        '131115-0.0', '131117-0.0', '131119-0.0', '131121-0.0', '131123-0.0', '131125-0.0',
        '131127-0.0',
        
        '27174-2.0', '27267-2.0', '27175-2.0', '27268-2.0', '27176-2.0', '27269-2.0', '27177-2.0',  # CT data
        '27270-2.0', '27178-2.0', '27271-2.0', '27179-2.0', '27272-2.0', '27180-2.0', '27273-2.0',
        '27204-2.0', '27297-2.0', '27181-2.0', '27274-2.0', '27182-2.0', '27275-2.0', '27183-2.0',
        '27276-2.0', '27184-2.0', '27277-2.0', '27185-2.0', '27278-2.0', '27186-2.0', '27279-2.0',
        '27188-2.0', '27281-2.0', '27187-2.0', '27280-2.0', '27189-2.0', '27282-2.0', '27190-2.0',
        '27283-2.0', '27191-2.0', '27284-2.0', '27192-2.0', '27285-2.0', '27193-2.0', '27286-2.0',
        '27194-2.0', '27287-2.0', '27195-2.0', '27288-2.0', '27196-2.0', '27289-2.0', '27197-2.0',
        '27290-2.0', '27198-2.0', '27291-2.0', '27199-2.0', '27292-2.0', '27200-2.0', '27293-2.0',
        '27201-2.0', '27294-2.0', '27202-2.0', '27295-2.0', '27203-2.0', '27296-2.0']

with open('/external/rprshnas01/tigrlab/scratch/bng/cartbind/code/MIND_models/aparc_base_id.txt') as f:
    id_set = set(line.strip() for line in f)

df = pd.read_csv('/external/rprshnas01/external_data/uk_biobank/tabular_data_csv/ukb51007.csv', usecols=cols, dtype=str)
filtered_df = df[df['eid'].astype(str).isin(id_set)]
filtered_df.to_csv('/external/rprshnas01/tigrlab/scratch/bng/cartbind/data/ukb_tabular.csv')

print(filtered_df.shape)
print("Filtered DataFrame saved to 'ukb_tabular.csv'.")

# duplicates = [item for item in cols if cols.count(item) > 1]
# if duplicates:
#     print("Duplicate columns found:", set(duplicates))
# else:
#     print("No duplicate columns found.")